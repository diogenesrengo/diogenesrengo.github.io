<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
        background-color: black;
      }
    </style>
  </head>
  <body>
    <canvas id="fireworksCanvas" width="800" height="600"></canvas>

    <script>
      const canvas = document.getElementById("fireworksCanvas");
      const ctx = canvas.getContext("2d");

      class Particle {
        constructor(x, y, color, velocity) {
          this.x = x;
          this.y = y;
          this.color = color;
          this.radius = Math.random() * 2 + 1;
          this.velocity = velocity;
          this.life = 100;
          this.alpha = 1;
          this.shimmer = Math.random() < 0.3;
        }
        draw() {
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
          let alpha = this.alpha;
          if (this.shimmer) { alpha *= 0.5 + Math.random() * 0.5; }
          ctx.fillStyle = `rgba(${this.color.r}, ${this.color.g}, ${this.color.b}, ${alpha})`;
          ctx.fill();
        }
        update() {
          this.x += this.velocity.x;
          this.y += this.velocity.y;
          this.velocity.y += 0.05;
          this.life--;
          this.alpha -= 0.01;
        }
      }

      class Firework {
        constructor(x, y) {
          this.x = x;
          this.y = canvas.height;
          this.targetX = x;
          this.targetY = y;
          this.color = { r: 255, g: 234, b: 0 }; //bright yellow
          const angle = (Math.random() * Math.PI) / 4 - Math.PI / 8;
          const speed = Math.random() * 3 + 5;
          this.velocity = { x: Math.sin(angle) * speed, y: -Math.cos(angle) * speed, };
          this.particles = [];
          this.trail = [];
          this.exploded = false;
          this.explosionProgress = 0;
          this.hasShimmer = Math.random() < 0.5;
        }
        explode() {
          for (let i = 0; i < 50; i++) {
            const angle = Math.random() * Math.PI * 2;
            const speed = Math.random() * 3 + 1;
            const velocity = {
              x: Math.cos(angle) * speed,
              y: Math.sin(angle) * speed,
            };
            this.particles.push( new Particle(this.x, this.y, this.color, velocity));
          }
          this.exploded = true;
        }
        update() {
          if (!this.exploded) {
            this.x += this.velocity.x;
            this.y += this.velocity.y;
            this.velocity.y += 0.05;
            this.trail.push(
              new Particle(this.x, this.y, this.color, { x: 0, y: 0 })
            );
            if (this.trail.length > 20) this.trail.shift();
            if (this.velocity.y >= 0 || this.y <= this.targetY) this.explode();
          } else {
            this.explosionProgress += 0.02;
            this.particles.forEach((particle) => {
              particle.update();
              particle.draw();
            });
            this.particles = this.particles.filter(
              (particle) => particle.life > 0
            );
          }
          this.trail.forEach((particle, index) => {
            particle.alpha =
              (index / this.trail.length) * (1 - this.explosionProgress);
            if (this.hasShimmer) {
              particle.shimmer = true;
            }
            particle.draw();
          });
        }
        draw() {
          if (!this.exploded) {
            ctx.beginPath();
            ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
            ctx.fillStyle = `rgb(${this.color.r}, ${this.color.g}, ${this.color.b})`;
            ctx.fill();
          }
        }
      }

      let fireworks = [];
      let amount = 10;
      let username = "rengo250";
      let message = amount + " tokens from " + username;

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        ctx.font = "15px Verdana";
        ctx.textAlign = "center";   
        ctx.fillText(message, canvas.width / 2, canvas.height - 10);

        fireworks.forEach((firework) => {firework.update(); firework.draw();});
        
        if (amount > 0 && Math.random() < 0.05) {
          fireworks.push(new Firework(
             Math.random() * canvas.width,
            (Math.random() * canvas.height) / 2
        ));
          amount--;
        }
        fireworks = fireworks.filter(
          (firework) => !firework.exploded || firework.particles.length > 0
        );
        requestAnimationFrame(animate);
      }
        
      if (amount > 0) 
          animate();

    </script>
  </body>
</html>
